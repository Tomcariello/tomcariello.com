<section class="page-puzzles">
  <div class="puzzles-header mb-4">
    <h2 class="display-6">Springbok Collection</h2>
    <p class="text-secondary">Explore the archive of vintage and modern puzzles.</p>
  </div>

  <div class="filter-toolbar bg-light p-3 rounded-4 mb-5 border">
    <form class="row g-3 align-items-center" id="puzzleFilterForm">
      <div class="col-auto">
        <label class="small text-muted d-block">Release Years</label>
        <div class="input-group input-group-sm">
          <input type="number" id="startYear" class="form-control" value="1980" style="width: 75px;">
          <span class="input-group-text">to</span>
          <input type="number" id="endYear" class="form-control" value="1990" style="width: 75px;">
        </div>
      </div>

      <div class="col-auto">
        <label for="pieceFilter" class="small text-muted d-block">Pieces</label>
        <select id="pieceFilter" class="form-select form-select-sm">
          <option value="all">All Sizes</option>
          <option value="500" selected>500 pcs</option>
          <option value="1000">1000 pcs</option>
          <option value="1500">1500+ pcs</option>
        </select>
      </div>

      <div class="col-auto pt-4">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="collectionOnly">
          <label class="form-check-label small" for="collectionOnly">In My Collection</label>
        </div>
      </div>

      <div class="col-md">
        <label class="small text-muted d-block">Search Archive</label>
        <div class="input-group input-group-sm">
          <span class="input-group-text bg-white border-end-0"><i class="fas fa-search text-muted"></i></span>
          <input type="text" id="puzzleSearch" class="form-control border-start-0" placeholder="Search by name or ID...">
        </div>
      </div>
    </form>
  </div>

  <div class="row g-4" id="puzzleGrid">
    {{#each puzzles}}
    <div class="col-xl-3 col-lg-4 col-sm-6 puzzle-card-wrapper" 
         data-year="{{this.year}}" 
         data-pieces="{{this.piece_count}}" 
         data-owned="{{this.in_collection}}"
         data-search="{{this.puzzle_name}} {{this.puzzle_id}}">
      
      <div class="card h-100 puzzle-card border-0 shadow-sm {{#if this.in_collection}}is-owned{{/if}}">
        
        <div class="puzzle-img-wrapper">
          {{#if this.image_box_front}}
            <img src="{{../s3Base}}{{this.image_box_front}}.png" alt="{{this.puzzle_name}}" loading="lazy" class="card-img-top">
          {{else}}
            <div class="no-image-placeholder">
              <i class="fas fa-camera-retro fa-2x mb-2"></i>
              <span>Image Coming Soon</span>
            </div>
          {{/if}}
          
          {{#if this.in_collection}}
            <div class="owned-tag">
              <i class="fas fa-home"></i> In Collection
            </div>
          {{/if}}
        </div>

        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="text-primary small fw-bold">#{{this.puzzle_id}}</span>
            <span class="badge rounded-pill bg-light text-dark border">{{this.year}}</span>
          </div>
          
          <h5 class="card-title h6 fw-bold mb-3" title="{{this.puzzle_name}}">
            {{this.puzzle_name}}
          </h5>

          <div class="puzzle-specs d-flex gap-2">
            <span class="badge bg-secondary-subtle text-secondary border-0">{{this.piece_count}} pcs</span>
            {{#if this.is_complete}}
              <span class="badge bg-primary-subtle text-primary border-0"><i class="fas fa-star"></i> Complete</span>
            {{/if}}
          </div>
        </div>

        {{#if this.how_acquired}}
        <div class="card-footer bg-light border-0 py-2">
          <small class="text-muted"><i class="fas fa-shopping-cart me-1"></i> {{this.how_acquired}}</small>
        </div>
        {{/if}}
      </div>
    </div>
    {{/each}}
  </div>
</section>